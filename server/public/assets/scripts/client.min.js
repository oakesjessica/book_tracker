var app=angular.module("bookApp",["ngRoute","smart-table"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/login",{templateUrl:"views/login.html",controller:"LoginController",controllerAs:"log"}).when("/register",{templateUrl:"views/register.html",controller:"RegisterController",controllerAs:"reg"}).when("/search",{templateUrl:"views/search.html",controller:"SearchController",controllerAs:"add"}).when("/library",{templateUrl:"views/library.html",controller:"LibraryController",controllerAs:"lib"}).when("/shelves",{templateUrl:"views/shelves.html",controller:"ShelvesController",controllerAs:"shelf"}).when("/locations",{templateUrl:"views/locations.html",controller:"LocationController",controllerAs:"loc"}).when("/borrowed",{templateUrl:"views/borrowed.html",controller:"BorrowController",controllerAs:"brw"}).when("/lent",{templateUrl:"views/lent.html",controller:"LentController",controllerAs:"lent"}).when("/favorites",{templateUrl:"views/favorites.html",controller:"FavoriteController",controllerAs:"fav"}).when("/wishlist",{templateUrl:"views/wishlist.html",controller:"WishController",controllerAs:"wish"}).when("/faq",{templateUrl:"views/faq.html",controller:"FaqController",controllerAs:"faq"}),b.html5Mode(!0)}]),app.controller("MainController",["UserService",function(a){var b=this;b.loginStatusData=a.data,console.log(b.loginStatus)}]),app.controller("LoginController",["UserService",function(a){var b=this;b.logInfo={},b.login=function(){console.log(b.logInfo),a.loginUser(b.logInfo)}}]),app.controller("RegisterController",["UserService",function(a){var b=this;b.newUser={},b.regUser=function(){console.log(b.newUser),a.registerNewUser(b.newUser),b.newUser={}}}]),app.controller("SearchController",function(){var a=this;a.page_title="Search List"}),app.controller("LibraryController",["BookService",function(a){var b=this;b.page_title="My Library",b.displayLibrary=[],b.libraryList=a.data,a.getLibrary(),console.log("lib",b.libraryList)}]),app.controller("ShelvesController",["BookService",function(a){var b=this;b.page_title="Shelf List",b.shelvesList=a.data,a.getByShelves(),console.log("shelves",b.shelvesList)}]),app.controller("LocationController",["BookService",function(a){var b=this;b.page_title="Locations List",b.locationsList=a.data,a.getByLocations()}]),app.controller("BorrowController",["BookService",function(a){var b=this;b.displayBorrowed=[],b.page_title="Books I'm Borrowing",b.borrowingList=a.borrowLentData,a.getBorrowedList(),b.emailBookOwner=function(a){console.log(a),console.log("owner ID",a.book_id,a.owner_id)}}]),app.controller("LentController",["BookService",function(a){var b=this;b.page_title="Books I've Lent Out",b.lendingList=a.borrowLentData,a.getLentList(),b.reminder=function(a){console.log(a),console.log(a.book_id,a.borrower_id)}}]),app.controller("FavoriteController",["BookService",function(a){var b=this;b.page_title="Favorites List",b.displayFavorites=[],b.favoritesList=a.data,a.getFavoritesList(),b.removeFavStar=function(b){a.removeFav(b.book_id)}}]),app.controller("WishController",["BookService",function(a){var b=this;b.page_title="Wish List",b.displayWishlist=[],b.wishList=a.data,a.getWishlist(),b.removeWishHeart=function(b){console.log(b.book_id),a.removeWish(b.book_id)}}]),app.controller("FaqController",function(){var a=this;a.page_title="FAQ List"}),app.factory("UserService",["$http","$location",function(a,b){var c=[],d={};return registerNewUser=function(b){console.log("newuser",b),a.post("/register",b).then(function(a){console.log(a)})},loginUser=function(c){console.log("logging in",c),a.post("/",c).then(function(a){console.log(a),200===a.status?(d.login=!0,b.path("/borrowed")):(d.login=!1,b.path("/login"))})},{key:{title:"value"},userData:c,registerNewUser:registerNewUser,loginUser:loginUser,data:d}}]),app.factory("BookService",["$http",function(a){function b(a,b){for(var c={},d=0;d<a.length;d++){var e=a[d][b];c[e]?c[e].push(a[d]):c[a[d][b]]=[a[d]]}return c}var c=[],d=[],e=function(){a.get("/library").then(function(a){console.log(a.data),angular.copy(a.data,c)})},f=function(){a.get("/wishlist").then(function(a){angular.copy(a.data,c)})},g=function(){a.get("/favorites").then(function(a){angular.copy(a.data,c)})},h=function(){a.get("/borrowed").then(function(a){d.curr=a.data.filter(function(a){return a.status===!0}),d.past=a.data.filter(function(a){return a.status===!1})})},i=function(){a.get("/lent").then(function(a){d.curr=a.data.filter(function(a){return a.status===!0}),d.past=a.data.filter(function(a){return a.status===!1})})},j=function(){a.get("/shelves").then(function(a){c.allShelves=b(a.data,"shelf_name"),console.log(c)})},k=function(){a.get("/locations").then(function(a){c.allLocations=b(a.data,"locations")})},l=function(b){console.log(b),a["delete"]("/favorites/"+b).then(function(a){g()})},m=function(b){console.log(b),a["delete"]("/wishlist/"+b).then(function(a){f()})};return{key:{title:"value"},getLibrary:e,getWishlist:f,getBorrowedList:h,getLentList:i,getFavoritesList:g,getByShelves:j,getByLocations:k,removeFav:l,removeWish:m,data:c,borrowLentData:d}}]);